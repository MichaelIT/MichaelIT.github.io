# Ubuntu Server 14.04 LTS 部署 Tengine

## 安装前准备

	$ apt-get update
    $ apt-get install libpcre++-dev libssl-dev zlib1g-dev git
    

## 源码安装

    $ git clone https://github.com/alibaba/tengine.git
    #注意，如果需要特定的编译选项，请查看文档加上，例如ipv6的支持需要加上参数--with-ipv6
    $ ./configure
	$ make
	$ make install

## 测试

	$ ln -s /usr/local/nginx/sbin/nginx /usr/bin/nginx
    #启动,注意，如果安装过nginx，会有冲突，请先卸载nginx
    $ nginx 
    #停止
    $ nginx -s stop
    #重启
    $ nginx -s reload
    #检查配置文件
    $ nginx -t
    

## 修改配置文件（可选）

Tengine兼容全部nginx语法，所以为了方便管理多个站点，这里修改一下配置文件。在最后一个'}'之前添加代码

	include /usr/local/nginx/conf/conf.d/*.conf;
   	include /usr/local/nginx/conf/sites-enabled/*;
 
结尾部分代码如下：

	
	  ...
      # HTTPS server
      #
      #server {
      #    listen       443 ssl;
      #    server_name  localhost;
      #    ssl_certificate      cert.pem;
      #    ssl_certificate_key  cert.key;
      #    ssl_session_cache    shared:SSL:1m;
      #    ssl_session_timeout  5m;
      #    ssl_ciphers  HIGH:!aNULL:!MD5;
      #    ssl_prefer_server_ciphers  on;
      #    location / {
      #        root   html;
      #        index  index.html index.htm;
      #    }
      #}
      include /usr/local/nginx/conf/conf.d/*.conf;
      include /usr/local/nginx/conf/sites-enabled/*;
	}
    
   
  	#重启
    $ nginx -s reload
    
    

## 配置Service和开机启动

配置服务：

	$ wget https://raw.github.com/JasonGiedymin/nginx-init-ubuntu/master/nginx -O /etc/init.d/nginx
    $ chmod 755 /etc/init.d/nginx
   
配置开机启动，配置开机启动使用到了一个方便的开机启动工具sysv-rc-conf

	$apt-get install sysv-rc-conf
    
    
	把行nginx的2勾上，退出即可
    ┌ SysV Runlevel Config   -: stop service  =/+: start service  h: help  q: quit ──────────────────────────────────────┐
    │                                                                                                                    │
    │ service      1       2       3       4       5       0       6       S                                             │
    │ ----------------------------------------------------------------------------                                       │
    │ aegis       [ ]     [X]     [X]     [X]     [X]     [ ]     [ ]     [ ]                                            │
    │ agentwatch  [ ]     [X]     [X]     [X]     [X]     [ ]     [ ]     [ ]                                            │
    │ apparmor    [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [X]                                            │
    │ console-s$  [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ cron        [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ dbus        [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ dns-clean   [X]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ friendly-$  [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ grub-comm$  [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ halt        [ ]     [ ]     [ ]     [ ]     [ ]     [X]     [ ]     [ ]                                            │
    │ irqbalance  [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ killprocs   [X]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ kmod        [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ networking  [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]     [ ]                                            │
    │ nginx       [ ]     [X]     [X]     [X]     [X]     [ ]     [ ]     [ ]                                            │
    │ nscd        [ ]     [X]     [X]     [X]     [X]     [ ]     [ ]     [ ]                                            │
    │ ntp         [ ]     [X]     [X]     [X]     [X]     [ ]     [ ]     [ ]                                            │
    │                                                                                                                    │
    └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
    ┌────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
    │ Use the arrow keys or mouse to move around.      ^n: next pg     ^p: prev pg                                       │
    │                        space: toggle service on / off                                                              │
    └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
    